angular.module("evaluationApp",["ngRoute"]),angular.module("evaluationApp").config(["$routeProvider",function(a){a.when("/login",{templateUrl:"../html/login.html",controller:"authenticationController"}).when("/evaluations/",{templateUrl:"../html/evaluations.html",controller:"evaluationsController"}).when("/evaluation/:semesterID/:courseID/:ID",{templateUrl:"../html/evaluation.html",controller:"evaluationController"}).otherwise({redirectTo:"/login"})}]),angular.module("evaluationApp").constant("SERVER_URL","http://dispatch.ru.is/demo/api/v1/"),angular.module("evaluationApp").service("currentUser",function(){return this.token="",this.username="",this.fullName="",this.role="",this.ssn="",this.imageURL="",this}),angular.module("evaluationApp").factory("evaluationResource",function(a,b,c){var d={};return d.loginUser=function(c){return a.post(b+"login",c)},d.getEvaluations=function(){return a.defaults.headers.common.Authorization="Basic "+c.token,a.get(b+"my/evaluations")},d.getEvaluation=function(d,e,f){return a.defaults.headers.common.Authorization="Basic "+c.token,a.get(b+"courses/"+e+"/"+f+"/evaluations/"+d)},d}),angular.module("evaluationApp").controller("authenticationController",["$scope","$location","$rootScope","$routeParams","$http","evaluationResource","currentUser",function(a,b,c,d,e,f,g){a.user="bergthor13",a.pass="123456",a.errorMessage="",a.warningMessage="",a.submitted=!1,a.login=function(){a.errorMessage="",a.submitted=!0;var d={user:a.user,pass:a.pass};a.loginForm.$valid&&f.loginUser(d).success(function(d){a.getUserData(d),c.$broadcast("userLoggedIn"),b.path("/evaluations")}).error(function(){a.errorMessage="Það kom upp villa. Þú hefur mögulega slegið inn rangt notandanafn eða lykilorð."})},a.getUserData=function(a){g.token=a.Token,g.username=a.User.Username,g.fullName=a.User.FullName,g.role=a.User.Role,g.ssn=a.User.SSN,g.imageURL=a.User.ImageURL},c.logout=function(){g.token="",g.username="",g.fullName="",g.role="",g.ssn="",g.imageURL="",b.path("/login")}}]),angular.module("evaluationApp").controller("evaluationController",["$scope","$location","$rootScope","$routeParams","$http","evaluationResource","currentUser",function(a,b,c,d,e,f,g){return""===g.username?void b.path("/login"):(a.evalID=d.ID,a.courseID=d.courseID,a.semesterID=d.semesterID,void f.getEvaluation(a.evalID,a.courseID,a.semesterID).success(function(a){console.log(a)}))}]),angular.module("evaluationApp").controller("evaluationsController",["$scope","$location","$rootScope","$routeParams","$http","evaluationResource","currentUser",function(a,b,c,d,e,f,g){return""===g.username?void b.path("/login"):(a.fullName=g.fullName,a.infoMessage="",a.evaluations={},f.getEvaluations().success(function(b){console.log(b),0===b.length&&(a.infoMessage="Engin kennslumöt, sem þú getur tekið, eru til staðar."),a.evaluations=b}).error(function(){}),void(a.dateIsActive=function(a,b){var c=new Date(a),d=new Date(b),e=new Date(Date.now());return e>c&&d>e}))}]),angular.module("evaluationApp").controller("indexController",["$scope","$rootScope","currentUser",function(a,b,c){b.$on("userLoggedIn",function(){a.userData=c})}]);